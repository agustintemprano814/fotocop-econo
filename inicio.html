<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Fotocop-Econo | Panel Principal</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/jpg" href="https://linktr.ee/og/image/franjaeconounlp.jpg">
    <style>
        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .module-card {
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 0px solid var(--primary);
            padding: 20px !important;
        }
        
        .module-card:hover {
            transform: translateY(-5px);
            border-left: 8px solid var(--primary);
            box-shadow: var(--shadow);
        }

        .module-options {
            max-height: 0;
            overflow: hidden;
            transition: all 0.4s ease;
            opacity: 0;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .module-card.expanded .module-options {
            max-height: 500px;
            opacity: 1;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(0,0,0,0.05);
        }

        .kpi-card { 
            border-top: 5px solid var(--primary) !important; 
            background: white; 
            padding: 20px; 
            display: none; 
            cursor: pointer; 
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .kpi-card:hover {
            transform: scale(1.02);
            box-shadow: var(--shadow);
        }
        .kpi-title { font-size: 0.7rem; color: var(--gray); font-weight: bold; text-transform: uppercase; display: block; }
        .kpi-value { font-size: 1.3rem; color: var(--dark); font-weight: 700; margin: 5px 0 0 0; }

        .panic-zone {
            margin-top: 40px;
            padding: 15px 25px;
            background: #fff5f5;
            border: 2px dashed #feb2b2;
            border-radius: 12px;
            display: none;
            align-items: center;
            justify-content: space-between;
        }
        .btn-panic {
            background-color: var(--danger);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            font-size: 0.85rem;
            cursor: pointer;
            width: auto !important;
        }
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 3000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(4px);
        }
        .modal-content {
            background: white;
            width: 90%;
            max-width: 500px;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .detalle-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .modal-header-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }

        .btn-print-mini {
            background: #e2e8f0;
            border: none;
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: 0.2s;
        }
        .btn-print-mini:hover { background: #cbd5e1; }
    </style>
</head>
<body>
    <div class="sidebar" id="sidebar"></div>

    <div class="main-content">
        <div class="container">
            <div class="user-welcome">
                <h2 id="saludo" style="border:none; margin:0; color: var(--primary);">Cargando...</h2>
                <p id="fechaHoy" style="color: var(--gray); font-size: 0.9rem;"></p>
            </div>

            <div class="kpi-grid">
                <div class="kpi-card" id="kpi-apuntes-caja">
                    <span class="kpi-title">APUNTES | Caja Hoy</span>
                    <p class="kpi-value" id="val-apuntes-caja">$ 0.00</p>
                    <small style="font-size: 10px; color: var(--gray);">Ver desglose de pagos</small>
                </div>
                
                <div class="kpi-card" id="kpi-apuntes-stock">
                    <span class="kpi-title">APUNTES | Alertas Stock</span>
                    <p class="kpi-value" id="val-apuntes-stock">0</p>
                    <small id="subtext-apuntes-stock" style="font-size: 10px; color: var(--gray);">Calculando...</small>
                </div>

                <div class="kpi-card" id="kpi-foto-caja">
                    <span class="kpi-title">FOTOCOP | Turno</span>
                    <p class="kpi-value" id="val-foto-caja">$ 0.00</p>
                    <small style="font-size: 10px; color: var(--gray);">Ver tipo de ventas</small>
                </div>

                <div class="kpi-card" id="kpi-foto-maquinas">
                    <span class="kpi-title">FOTOCOP | Estado</span>
                    <p class="kpi-value" id="val-foto-maquinas">-</p>
                    <small id="subtext-foto-maquinas" style="font-size: 10px; color: var(--gray);">Reporte t√©cnico</small>
                </div>
            </div>

            <div class="module-grid">
                <div class="card module-card" id="mod-venta">
                    <span>üí∞</span>
                    <h3>Punto de Venta</h3>
                    <div class="module-options">
                        <button class="btn btn-primary" id="btn-nav-apuntes">üìö Sector Apuntes</button>
                        <button class="btn btn-primary" id="btn-nav-ventas">üñ®Ô∏è Sector Fotocopiadora</button>
                    </div>
                </div>

                <div class="card module-card" id="mod-almacen">
                    <span>üì¶</span>
                    <h3>Gesti√≥n de Almac√©n</h3>
                    <div class="module-options">
                        <button class="btn btn-primary" id="btn-nav-stock">üõí Stock Apuntes</button>
                        <button class="btn btn-primary" id="btn-nav-insumos">üõ†Ô∏è Insumos</button>
                        <button class="btn btn-primary" id="btn-nav-estado">‚öôÔ∏è M√°quinas</button>
                        <button class="btn btn-primary" id="btn-nav-editor">‚úèÔ∏è Editor</button>
                    </div>
                </div>

                <div class="card module-card" id="mod-admin" style="display:none;">
                    <span>üìë</span>
                    <h3>Administraci√≥n</h3>
                    <p>Control de cajas y exportaci√≥n por sector.</p>
                    <div class="module-options">
                        <button class="btn btn-primary" id="btn-nav-cierre-ap">üìö Cierre Apuntes</button>
                        <button class="btn btn-primary" id="btn-nav-cierre-fo">üñ®Ô∏è Cierre Fotocopiadora</button>
                        <button class="btn btn-primary" id="btn-nav-reportes">üìÇ Exportar Reportes</button>
                    </div>
                </div>

                <div class="card module-card" id="mod-control" style="display:none;">
                    <span>üìä</span>
                    <h3>Panel de Control</h3>
                    <div class="module-options">
                        <button class="btn btn-accent" id="btn-nav-dash-fin">üìà Finanzas</button>
                        <button class="btn btn-accent" id="btn-nav-dash-tec">üìâ Rendimiento</button>
                    </div>
                </div>

                <div class="card module-card" id="mod-sistema" style="display:none;">
                    <span>üõ°Ô∏è</span>
                    <h3>Gesti√≥n de Sistemas</h3>
                    <div class="module-options">
                        <button class="btn btn-dark" id="btn-nav-usuarios">üë• Usuarios</button>
                        <button class="btn btn-dark" id="btn-nav-config">‚öôÔ∏è Configuraci√≥n</button>
                        <button class="btn btn-dark" id="btn-nav-import">üì• Importador</button>
                    </div>
                </div>
            </div>

            <div id="panicZone" class="panic-zone">
                <div>
                    <h4 style="margin:0; color:#c53030;">‚ö†Ô∏è Protocolo de Emergencia</h4>
                    <p style="margin:5px 0 0 0; font-size:0.75rem; color:#742a2a;">Apagar el sistema para mantenimiento.</p>
                </div>
                <button class="btn-panic" id="btn-panic-action">Apagar Sistema</button>
            </div>
        </div>
    </div>

    <div id="modalStock" class="modal-overlay">
        <div class="modal-content">
            <h3 style="color:var(--danger); margin-top:0;">‚ö†Ô∏è Alertas de Inventario</h3>
            <ul id="listaFaltantes" style="margin:20px 0; max-height:250px; overflow-y:auto; padding-right:10px; border-top:1px solid #eee; border-bottom:1px solid #eee; padding-top:15px;"></ul>
            <button class="btn btn-dark" id="btnCerrarModal" style="width:100%;">Entendido</button>
        </div>
    </div>

    <div id="modalMaquinas" class="modal-overlay">
        <div class="modal-content">
            <h3 style="color:var(--dark); margin-top:0;">üõ†Ô∏è Estado T√©cnico</h3>
            <div id="listaMaquinasEstado" style="margin:20px 0;"></div>
            <button class="btn btn-dark" id="btnCerrarModalMaq" style="width:100%;">Cerrar</button>
        </div>
    </div>

    <div id="modalDetalleApuntes" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header-actions">
                <h3 style="color:var(--primary); margin:0;">üí∞ Detalle Caja Apuntes</h3>
                <button id="btnImprimirApuntes" class="btn-print-mini">üñ®Ô∏è Imprimir</button>
            </div>
            <div id="cuerpoDetalleApuntes" style="margin:20px 0;"></div>
            <button class="btn btn-dark" id="btnCerrarApuntes" style="width:100%;">Cerrar</button>
        </div>
    </div>

    <div id="modalDetalleFoto" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header-actions">
                <h3 style="color:var(--primary); margin:0;">üìä Detalle Caja Fotocopiadora</h3>
                <button id="btnImprimirFoto" class="btn-print-mini">üñ®Ô∏è Imprimir</button>
            </div>
            <div id="cuerpoDetalleFoto" style="margin:20px 0;"></div>
            <button class="btn btn-dark" id="btnCerrarFoto" style="width:100%;">Cerrar</button>
        </div>
    </div>

    <script type="module" src="inicio.js"></script>
</body>
</html>